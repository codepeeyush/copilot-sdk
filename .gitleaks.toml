# Gitleaks configuration for yourgpt-copilot SDK
# Scans for secrets and blocks .env files (except .env.example)

title = "Gitleaks config for yourgpt-copilot"

# Use all default secret detection rules
[extend]
useDefault = true

# Block .env files
[[rules]]
id = "env-files-blocker"
description = "Block .env files from being committed (except .env.example)"
regex = '''.*'''
path = '''\.env.*'''
tags = ["env", "config"]

# OpenAI API Key
[[rules]]
id = "openai-api-key"
description = "OpenAI API Key"
regex = '''sk-[a-zA-Z0-9]{20,}'''
tags = ["api-key", "openai"]

# Anthropic API Key
[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-[a-zA-Z0-9_\-]{20,}'''
tags = ["api-key", "anthropic"]

# Generic API Key
[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?secret)["\s:=]+[a-zA-Z0-9_\-]{20,}'''
tags = ["api-key", "secret"]

# Bearer Token
[[rules]]
id = "bearer-token"
description = "Bearer Token"
regex = '''(?i)bearer\s+[a-zA-Z0-9_\-\.=]+'''
tags = ["token", "auth"]

# JWT Token
[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[a-zA-Z0-9_-]+\.eyJ[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+'''
tags = ["jwt", "token"]

# Global allowlist
[allowlist]
description = "Global allowlist for safe files"
paths = [
    '''\.gitleaks\.toml$''',
    '''\.env\.example$''',
    '''package-lock\.json$''',
    '''yarn\.lock$''',
    '''pnpm-lock\.yaml$''',
    '''\.md$''',
]
regexes = [
    '''example''',
    '''sample''',
    '''test''',
    '''mock''',
    '''dummy''',
    '''your-api-key''',
    '''YOUR_API_KEY''',
    '''process\.env\.\w+''',
]
